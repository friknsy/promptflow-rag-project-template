inputs:
  query:
    type: string
    default: '"Could you please list azure data products?"'
outputs:
  out:
    type: list
    reference: ${python_node_qnsw.output}
nodes:
- name: vector_embedding
  type: python
  source:
    type: package
    tool: promptflow.tools.embedding.embedding
  inputs:
    connection: aoai_connection
    deployment_name: text-embedding-ada-002
    input: ${inputs.query}
- name: python_node_qnsw
  type: python
  source:
    type: code
    path: python_node_qnsw.py
  inputs:
    query_embedding: ${vector_embedding.output}
    db_name: testdb
    collection_name: tescol
    num_results: 3
    uri: mongodb+srv://mongodb:1919Shattuck@appliedaimongodb.mongocluster.cosmos.azure.com/?tls=true&authMechanism=SCRAM-SHA-256&retrywrites=false&maxIdleTimeMS=120000
- name: Azure_CosmosDB_MongoDB_vCore_Vector_Search_ypz1
  type: python
  source:
    type: package
    tool: pfazuredb.tools.mongodbvcore.vectorsearch
  inputs:
    connection: cosmodb_connection
    db_name: earning_calls
    collection_name: MSFTFY23Q1
    num_results: 3
    embeddings: ${vector_embedding.output}
